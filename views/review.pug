
extends layout.pug

append head 
    //- defer helps to make sure the scripts only run after the full template is rendered
    script(src="/javascripts/reviews-scripts.js" type="module" defer )
block content
    if errors
        div(class="errors")
        ul
            each error in errors
                li= error
    if review
        div(id="reviewContainer")
            div(id="starContainer")
                    - let i = 0
                    - let j = review.rating
                    while i < review.rating
                        span(class="fa fa-star checked")
                        - i++
                    while j < 5
                        span(class="fa fa-star")
                        - j++
            div(id="reviewBody")= review.body
            div(id="buttonContainer")

                button(type="submit" id= "updateReview") Edit Review

                form(action=`/reviews/${review.id}/delete` method='post')
                    input(type="hidden" name="_csrf" value= csrfToken)
                    button(type="submit") Delete Review
                    
            div(id="formContainer")
                form(action=`/reviews/${review.id}/` method='post' class="updateForm hidden")
                
                    input(type="hidden" name="_csrf" value= csrfToken)

                    label(for="rating") Rating
                    input(type="number" name="rating" value= review.rating required)
                    div(id="starContainer")
                        - let a = 0
                        - let b = review.rating
                        while a < review.rating
                            span(class="fa fa-star checked")
                            - a++
                        while b < 5
                            span(class="fa fa-star")
                            - b++

                    //- label(for="body") Write your review here
                    textarea(name="body" id="body" cols="30", rows="10" required) #{review.body}
                    button(type="submit" id= "update") Submit Review
        
        //- form(action=`/reviews/${review.id}/delete` method='post')
        //-     input(type="hidden" name="_csrf" value= csrfToken)
        //-     button(type="submit") Delete Review
        
